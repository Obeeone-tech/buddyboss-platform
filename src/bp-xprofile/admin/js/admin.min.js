function add_option(e){var t=document.getElementById(e+"_more"),o=document.getElementById(e+"_option_number").value,i=document.createElement("div"),n=document.createElement("span"),r="socialnetworks"!==e?document.createElement("input"):document.createElement("select"),d=document.createElement("label"),l=document.createElement("input"),s=document.createTextNode("Default Value"),a=document.createTextNode("Delete"),u=document.createElement("div"),p=0,c=document.createElement("a");if(i.setAttribute("id",e+"_div"+o),i.setAttribute("class","bp-option sortable"),n.setAttribute("class","bp-option-icon grabber"),"gender"===e){r.setAttribute("type","text"),r.setAttribute("name",e+"_option["+o+"_other]"),r.setAttribute("id",e+"_option"+o);var f=document.createElement("input");f.setAttribute("type","hidden"),f.setAttribute("name",e+"-option-order[]"),i.appendChild(f)}else if("socialnetworks"===e){r.setAttribute("name",e+"_option["+o+"]"),r.setAttribute("id",e+"_option"+o),r.setAttribute("class","select-social-networks");f=document.createElement("option");for(f.text="Select",f.setAttribute("value",""),r.add(f),p=0;p<XProfileAdmin.social_networks_provider.length;p++){var _=document.createElement("option");_.text=XProfileAdmin.social_networks_provider[p],_.setAttribute("value",XProfileAdmin.social_networks_provider_value[p]),r.add(_)}}else r.setAttribute("type","text"),r.setAttribute("name",e+"_option["+o+"]"),r.setAttribute("id",e+"_option"+o);"checkbox"===e||"multiselectbox"===e?(l.setAttribute("type","checkbox"),l.setAttribute("name","isDefault_"+e+"_option["+o+"]")):"gender"!==e&&(l.setAttribute("type","radio"),l.setAttribute("name","isDefault_"+e+"_option")),l.setAttribute("value",o),"gender"===e?c.setAttribute("href",'javascript:remove_div("'+e+"_div"+o+'")'):c.setAttribute("href",'javascript:hide("'+e+"_div"+o+'")'),c.setAttribute("class","delete"),c.appendChild(a),u.setAttribute("class","delete-button"),u.appendChild(c),"gender"===e?(s=document.createTextNode(" Other"),d.appendChild(s)):"socialnetworks"===e||(d.appendChild(document.createTextNode(" ")),d.appendChild(l),d.appendChild(document.createTextNode(" ")),d.appendChild(s),d.appendChild(document.createTextNode(" "))),i.appendChild(n),i.appendChild(document.createTextNode(" ")),i.appendChild(r),"socialnetworks"!==e&&i.appendChild(d),i.appendChild(u),t.appendChild(i),enableSortableFieldOptions(e),document.getElementById(e+"_option"+o).focus(),"socialnetworks"===e&&o===XProfileAdmin.social_networks_provider_count&&jQuery(".social_networks_add_more").hide(),o++,document.getElementById(e+"_option_number").value=o}function show_options(t){var o,i,n=jQuery('body #wpwrap #wpcontent #wpbody #wpbody-content .wrap #bp-xprofile-add-field #poststuff #post-body .postbox-container #submitdiv .inside #submitcomment #major-publishing-actions #publishing-action :input[type="submit"]');if("gender"===t)n.prop("disabled",!0),jQuery.ajax({url:ajaxurl,type:"post",data:{action:"xprofile_check_gender_added_previously",type:"gender",referer:jQuery("#bp-xprofile-add-field").find('input[name="_wp_http_referer"]').val()},success:function(e){e=jQuery.parseJSON(e);if("added"===e.status){for(alert(e.message),jQuery("#fieldtype").val(""),jQuery("#fieldtype").val("textbox"),t="textbox",i=0;i<XProfileAdmin.do_settings_section_field_types.length;i++)document.getElementById(XProfileAdmin.do_settings_section_field_types[i]).style.display="none";o=0<=XProfileAdmin.do_settings_section_field_types.indexOf(t)?(document.getElementById(t).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(o),jQuery(document).trigger("bp-xprofile-show-options",t)}else{for(i=0;i<XProfileAdmin.do_settings_section_field_types.length;i++)document.getElementById(XProfileAdmin.do_settings_section_field_types[i]).style.display="none";o=0<=XProfileAdmin.do_settings_section_field_types.indexOf(t)?(document.getElementById(t).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(o),jQuery(document).trigger("bp-xprofile-show-options",t)}n.prop("disabled",!1)},error:function(){n.prop("disabled",!1)}});else if("membertypes"===t)n.prop("disabled",!0),jQuery.ajax({url:ajaxurl,type:"post",data:{action:"xprofile_check_member_type_added_previously",type:"membertypes",referer:jQuery("#bp-xprofile-add-field").find('input[name="_wp_http_referer"]').val()},success:function(e){e=jQuery.parseJSON(e);if("added"===e.status){for(alert(e.message),jQuery("#fieldtype").val(""),jQuery("#fieldtype").val("textbox"),t="textbox",i=0;i<XProfileAdmin.do_settings_section_field_types.length;i++)document.getElementById(XProfileAdmin.do_settings_section_field_types[i]).style.display="none";o=0<=XProfileAdmin.do_settings_section_field_types.indexOf(t)?(document.getElementById(t).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(o),jQuery(document).trigger("bp-xprofile-show-options",t)}else{for(i=0;i<XProfileAdmin.do_settings_section_field_types.length;i++)document.getElementById(XProfileAdmin.do_settings_section_field_types[i]).style.display="none";o=0<=XProfileAdmin.do_settings_section_field_types.indexOf(t)?(document.getElementById(t).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(o),jQuery(document).trigger("bp-xprofile-show-options",t)}n.prop("disabled",!1)},error:function(){n.prop("disabled",!1)}});else if("socialnetworks"===t)n.prop("disabled",!0),jQuery.ajax({url:ajaxurl,type:"post",data:{action:"xprofile_check_social_networks_added_previously",type:"socialnetworks",referer:jQuery("#bp-xprofile-add-field").find('input[name="_wp_http_referer"]').val()},success:function(e){e=jQuery.parseJSON(e);if("added"===e.status){for(alert(e.message),jQuery("#fieldtype").val(""),jQuery("#fieldtype").val("textbox"),t="textbox",i=0;i<XProfileAdmin.do_settings_section_field_types.length;i++)document.getElementById(XProfileAdmin.do_settings_section_field_types[i]).style.display="none";o=0<=XProfileAdmin.do_settings_section_field_types.indexOf(t)?(document.getElementById(t).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(o),jQuery(document).trigger("bp-xprofile-show-options",t)}else{for(i=0;i<XProfileAdmin.do_settings_section_field_types.length;i++)document.getElementById(XProfileAdmin.do_settings_section_field_types[i]).style.display="none";o=0<=XProfileAdmin.do_settings_section_field_types.indexOf(t)?(document.getElementById(t).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(o),jQuery(document).trigger("bp-xprofile-show-options",t)}n.prop("disabled",!1)},error:function(){n.prop("disabled",!1)}});else{for(i=0;i<XProfileAdmin.do_settings_section_field_types.length;i++)document.getElementById(XProfileAdmin.do_settings_section_field_types[i]).style.display="none";o=0<=XProfileAdmin.do_settings_section_field_types.indexOf(t)?(document.getElementById(t).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(o),jQuery(document).trigger("bp-xprofile-show-options",t)}}function hide(e){if(!document.getElementById(e))return!1;document.getElementById(e).style.display="none";e=e.replace("div","option");document.getElementById(e).value=""}function remove_div(e){if(!document.getElementById(e))return!1;document.getElementById(e).remove()}function toggle_no_member_type_notice(){var e,t=jQuery("input.member-type-selector");t.length&&(e=!1,t.each(function(){if(jQuery(this).is(":checked"))return!(e=!0)}),e?jQuery("p.member-type-none-notice").addClass("hide"):jQuery("p.member-type-none-notice").removeClass("hide"))}var fixHelper=function(e,t){return t.children().each(function(){jQuery(this).width(jQuery(this).width())}),t};function enableSortableFieldOptions(){jQuery(".bp-options-box").sortable({cursor:"move",items:"div.sortable",tolerance:"intersect",axis:"y"}),jQuery(".sortable, .sortable span").css("cursor","move")}function destroySortableFieldOptions(){jQuery(".bp-options-box").sortable("destroy"),jQuery(".sortable, .sortable span").css("cursor","default")}function titleHint(e){e=e||"title";var t=jQuery("#"+e),o=jQuery("#"+e+"-prompt-text");""===t.val()?o.removeClass("screen-reader-text"):o.addClass("screen-reader-text"),o.click(function(){jQuery(this).addClass("screen-reader-text"),t.focus()}),t.blur(function(){""===this.value&&o.removeClass("screen-reader-text")}).focus(function(){o.addClass("screen-reader-text")}).keydown(function(e){o.addClass("screen-reader-text"),jQuery(this).unbind(e)})}function sortFieldOptions(e){var t=[],o=e.val(),e=e.closest(".bp-options-box");e.find('input[type="text"]').each(function(){t.push(jQuery(this).val())}),"asc"===o?t.sort():"desc"===o&&(t.sort(),t.reverse()),e.find('input[type="text"]').each(function(e){jQuery(this).val(t[e])})}jQuery(document).ready(function(){jQuery("#bp-xprofile-add-field #title").focus(),toggle_no_member_type_notice(),jQuery("input.member-type-selector").on("change",function(){toggle_no_member_type_notice()}),jQuery("a.ajax-option-delete").on("click",function(){var e=(e=this.id.split("-"))[1];jQuery.post(ajaxurl,{action:"xprofile_delete_option",cookie:encodeURIComponent(document.cookie),_wpnonce:jQuery("input#_wpnonce").val(),option_id:e},function(){})}),jQuery('[id^="sort_order_"]').change(function(){"custom"!==jQuery(this).val()?("move"===jQuery(".sortable, .sortable span").attr("cursor")&&destroySortableFieldOptions(),sortFieldOptions(jQuery(this))):enableSortableFieldOptions(jQuery("#fieldtype :selected").val())}),jQuery("ul#field-group-tabs").show(),jQuery("ul#field-group-tabs").sortable({cursor:"move",axis:"x,y",opacity:1,items:"li:not(.not-sortable)",tolerance:"intersect",update:function(){jQuery.post(ajaxurl,{action:"xprofile_reorder_groups",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_groups:jQuery("input#_wpnonce_reorder_groups").val(),group_order:jQuery(this).sortable("serialize")},function(){})}}).disableSelection(),jQuery("fieldset.field-group").sortable({cursor:"move",opacity:.7,items:"fieldset.sortable",tolerance:"pointer",update:function(){jQuery.post(ajaxurl,{action:"xprofile_reorder_fields",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_fields:jQuery("input#_wpnonce_reorder_fields").val(),field_order:jQuery(this).sortable("serialize"),field_group_id:jQuery(this).attr("id")},function(){})}}).disableSelection(),enableSortableFieldOptions(jQuery("#fieldtype :selected").val()),titleHint("title");var e=jQuery('input[name="date_format"]'),t=jQuery("#date-format-custom-value"),o=jQuery("#date-format-custom-sample");e.click(function(e){switch(e.target.value){case"elapsed":t.val(""),o.html("");break;case"custom":break;default:t.val(e.target.value),o.html(jQuery(e.target).siblings(".date-format-label").html())}});var i=jQuery("#date-format-custom");t.focus(function(){i.prop("checked","checked")});var n=jQuery("#date-format-custom-spinner");t.change(function(e){n.addClass("is-active"),jQuery.post(ajaxurl,{action:"date_format",date:e.target.value},function(e){n.removeClass("is-active"),o.html(e)})});var r,d,e=jQuery("#tabs").tabs();d=e,r=jQuery("ul:first li",d).droppable({accept:".connectedSortable fieldset:not(.primary_field)",hoverClass:"ui-state-hover",activeClass:"ui-state-acceptable",touch:"pointer",tolerance:"pointer",drop:function(e,t){function o(e){var t,o={action:"xprofile_reorder_fields",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_fields:jQuery("input#_wpnonce_reorder_fields").val()};d.tabs("option","active",r.index(i)),n=jQuery(i.find("a").attr("href")).find(".connectedSortable"),jQuery(n).find("p.nofields").hide("slow"),jQuery.extend(o,{field_group_id:jQuery(n).attr("id"),group_tab:jQuery(i).prop("id")}),t=jQuery(n).sortable("serialize"),e?(e=e.replace("draggable_field_","draggable_signup_field[]="),t?t+="&"+e:t=e,jQuery.extend(o,{new_signup_field_id:e})):(jQuery(this).appendTo(n).show("slow").animate({opacity:"1"},500),n=jQuery(i.find("a").attr("href")).find(".connectedSortable"),t=jQuery(n).sortable("serialize"),jQuery.extend(o,{field_group_id:jQuery(n).attr("id")})),jQuery.extend(o,{field_order:t}),jQuery.post(ajaxurl,o,function(e){e.data&&e.data.signup_field&&(jQuery(n).append(e.data.signup_field),e.data.field_id&&jQuery("#draggable_field_"+e.data.field_id+" legend").append(jQuery("<span></span>").addClass("bp-signup-field-label").html(XProfileAdmin.signup_info)))},"json").always(function(){0})}var i=jQuery(this),n=jQuery(i.find("a").attr("href")).find(".connectedSortable");jQuery(i).removeClass("drop-candidate"),"signup-group"===jQuery(i).prop("id")?o(t.draggable.prop("id")):t.draggable.prop("id").match(/draggable_signup_field_([0-9]+)/)||t.draggable.hide("slow",o)},over:function(){jQuery(this).addClass("drop-candidate")},out:function(){jQuery(this).removeClass("drop-candidate")}}),jQuery(".delete-profile-field-group").click(function(){return confirm(XProfileAdmin.confirm_delete_field_group)}),jQuery(document).on("change",".select-social-networks",function(){var t=this,o=this.id,i=this.value;jQuery(".select-social-networks").each(function(){var e;o!==this.id&&(e=jQuery("#"+this.id).val(),i===e&&(t.value="",alert(XProfileAdmin.social_networks_duplicate_value_message)))})}),jQuery("#signup-fields .removal").on("click",function(e){e.preventDefault();var t=jQuery(e.target).attr("href").replace("#remove_field-",""),o=jQuery(e.target).closest("#draggable_signup_field_"+t);if(!t)return!1;jQuery.post(ajaxurl,{action:"xprofile_remove_signup_field",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_fields:jQuery("input#_wpnonce_reorder_fields").val(),signup_field_id:t},function(e){e.success&&(jQuery(o).remove(),jQuery("#draggable_field_"+t+" .bp-signup-field-label").remove())},"json")})});